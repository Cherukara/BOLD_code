% xSegmentationResults.m
%
% Plotting the outcome of different segmentation methods
%
% MT Cherukara
% 14 June 2019

clear;
close all;

setFigureDefaults;

%% Odd-One-Out Data

O_T1 = [  3.5300    6.8900    3.1000    2.2300    2.5000
          7.8800    9.8100    7.5000    5.6100    4.2300
         10.6200   11.2300   10.7200    9.0300    8.1100
         10.3100    8.5300   12.2900    9.6800   10.4200
          0.9700    1.1400    0.9900    1.5300    2.7000
          0.0300    0.0100    0.0300    0.0200    0.0800 ];
     
O_T2 = [ 12.8900   16.3400   15.3000   21.4600   15.9300
          1.6900    3.6100    3.2200    6.0000    3.9800
          1.5600    0.7700    3.2800    2.8100    2.0200
          1.4000    0.7500    1.6900    1.2100    0.7500
          2.3500    8.9100    2.3400    0.9900    3.8500
          2.9800   11.4100    3.0400    1.4000    5.2500 ];
      
O_BF = [  0.8900    1.5000    0.6100    0.2500    1.4700
          1.8500    4.1500    1.1000    0.4100    3.0900
          1.6700    8.2800    1.3500    0.4300    2.2900
          6.7100   10.9300    7.4500    4.3900    6.7000
          6.0800    8.8700    7.9700    8.1400    5.5400
          4.7300    7.4700    6.0900    6.7900    4.5900 ];
      
O_FC = [ 15.1600    9.7100    9.5700   11.6500    8.5800
         46.0200   40.4700   37.3400   39.4500   43.8000
         10.4600   13.1800   12.7600   13.9900   18.2300
          0.2200    0.2500    0.5800    0.1900    0.3800
          1.0900    0.0600    1.8500    1.3100    0.7000
          0.4000         0    0.3700    0.9000    0.1600 ];
      
%% Pairwise Dice Coefficient Data

D_T1T2 = [ 0.7910    0.7340    0.7700    0.7130    0.7710
           0.8380    0.7930    0.8190    0.8120    0.8470
           0.8510    0.8000    0.8320    0.8540    0.8540
           0.8640    0.8150    0.8430    0.8790    0.8510
           0.8590    0.8250    0.8350    0.8950    0.8510
           0.8520    0.8280    0.8250    0.8930    0.8510 ];
       
D_T1BF = [ 0.5520    0.4430    0.5890    0.5550    0.5010
           0.7880    0.6860    0.7750    0.7940    0.7990
           0.8020    0.7340    0.7810    0.8100    0.8130
           0.8100    0.7980    0.7740    0.8160    0.8160
           0.8230    0.8430    0.7790    0.8270    0.8400
           0.8350    0.8680    0.7940    0.8390    0.8570 ];
       
D_T1FC = [ 0.4460    0.3860    0.5380    0.4860    0.4700
           0.3630    0.3260    0.4440    0.4580    0.4210
           0.7050    0.6240    0.6720    0.6900    0.6580
           0.8730    0.8220    0.8370    0.8510    0.8560
           0.9780    0.9690    0.9690    0.9670    0.9570
           0.9960    1.0000    0.9960    0.9910    0.9970 ];
       
D_T2BF = [ 0.4950    0.3740    0.5060    0.4080    0.4060
           0.8670    0.7520    0.8490    0.8450    0.8310
           0.8840    0.7780    0.8610    0.8880    0.8780
           0.8970    0.7930    0.8750    0.8930    0.8900
           0.9140    0.8030    0.8940    0.9040    0.8970
           0.9230    0.8110    0.9090    0.9180    0.9010 ];
       
D_T2FC = [ 0.3160    0.2660    0.3770    0.2480    0.2950
           0.4080    0.3840    0.4550    0.3990    0.3940
           0.8050    0.7900    0.7410    0.7370    0.7140
           0.9640    0.9830    0.9490    0.9430    0.9760
           0.8590    0.8530    0.8270    0.9010    0.8770
           0.8490    0.8290    0.8210    0.8840    0.8500 ];
       
D_BFFC = [ 0.7950    0.8540    0.8530    0.8310    0.8550
           0.4550    0.4810    0.5420    0.5300    0.4600
           0.8520    0.7050    0.8310    0.8290    0.7500
           0.9120    0.7960    0.9020    0.9420    0.8920
           0.8210    0.8360    0.7700    0.8250    0.8540
           0.8310    0.8680    0.7900    0.8300    0.8570 ];
    
      
%% Combine into Matrices

% combine it all into one matrix;
O_all = [O_T1(:), O_T2(:), O_BF(:), O_FC(:)];
lblsO = {'T1','T2','BF','FC'};
thrs = {'5','20','40','60','80','95'};

% combine Dice coeffs
D_all = [D_T1T2(:), D_T1BF(:), D_T1FC(:), D_T2BF(:), D_T2FC(:), D_BFFC(:)];
lblsD = {'T1-T2','T1-BF','T1-FC','T2-BF','T2-FC','BF-FC'};

%% Do statistical analyses

% later

%% Plot Odd-One-Out
% all CSF
figure; 
boxplot((O_all),'Symbol','');
axis square; grid on; hold on;
ylim([-1,25]);
xticklabels(lblsO);
ylabel('Inconsistent Voxels (%)');
title('All Thresholds');

% plot specific threshold
for tt = [4:6]
    
    % make matrix
    O_th = [O_T1(tt,:)', O_T2(tt,:)', O_BF(tt,:)', O_FC(tt,:)'];
    
    % plot
    figure;
    boxplot((O_th),'Symbol','');
    axis square; grid on; hold on;
    ylim([-0.5,14]);
    xticklabels(lblsO);
    ylabel('Inconsistent Voxels (%)');
    title([thrs{tt},'% CSF Threshold']);
end

% %% Plot Dice
% % all CSF
% figure; 
% boxplot(D_all,'Symbol','');
% grid on; hold on;
% ylim([0,1.05]);
% xticklabels(lblsD);
% ylabel('Dice Similarity Coefficient');
% title('All Subjects, All CSF');
% 
% % plot specific threshold
% for tt = [1,2]
%     
%     % make matrix
%     D_th = [D_T1T2(tt,:)', D_T1BF(tt,:)', D_T1FC(tt,:)',...
%             D_T2BF(tt,:)', D_T2FC(tt,:)', D_BFFC(tt,:)'];
%     
%     % plot
%     figure;
%     boxplot(D_th,'Symbol','');
%     grid on; hold on;
%     ylim([0,1.05]);
%     xticklabels(lblsD);
%     ylabel('Dice Similarity Coefficient');
%     title([thrs{tt},'% CSF Threshold']);
% end
