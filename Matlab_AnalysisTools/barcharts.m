% Bar Charts

clear;
close all;
setFigureDefaults;

%% Data

% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % %
% % %    MEDIAN DATA        % % % % % % % % % % % % % % % % % % % % % % % % % %
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % %

%       sq-LS   sq-VB   1C-VB   1CS-VB  1C-VBI  2C-VB   2C-VBI  BV-VBI  19-VB
R2p = [ 2.818,  2.930,  2.869,  2.926,  2.946,  2.730,  2.767,  3.002,  3.027; ...
        3.076,  3.218,  3.046,  3.131,  3.109,  2.853,  2.903,  3.147,  3.287; ...
        2.244,  2.358,  2.339,  2.330,  2.400,  2.192,  2.221,  2.537,  2.465; ...
        2.533,  2.727,  2.659,  2.874,  2.729,  2.492,  2.536,  2.869,  2.829; ...
        2.524,  2.724,  2.593,  2.672,  2.649,  2.312,  2.414,  2.764,  2.735; ...
        2.889,  3.006,  2.975,  3.137,  3.043,  2.778,  2.889,  3.080,  3.154; ...
        2.265,  2.328,  2.195,  2.175,  2.333,  2.007,  2.149,  2.478,  2.231 ];
    
%       sq-LS   sq-VB   1C-VB   1CS-VB  1C-VBI  2C-VB   2C-VBI  BV-VBI  19-VB
DBV = [ 3.679,  4.047,  3.937,  4.206,  3.896,  4.145,  3.852,  3.869,  4.442; ...
        4.844,  5.697,  4.717,  5.398,  4.060,  5.012,  4.031,  4.065,  5.917; ...
        3.375,  3.846,  3.242,  3.649,  3.407,  3.483,  3.289,  3.327,  3.780; ...
        3.963,  4.657,  4.210,  4.968,  3.879,  4.299,  3.843,  3.887,  4.960; ...
        4.073,  4.724,  4.549,  5.019,  4.052,  4.411,  4.066,  4.053,  5.177; ...
        4.042,  4.462,  4.170,  4.752,  3.883,  4.250,  3.899,  3.908,  4.946; ...
        3.718,  4.045,  3.405,  3.856,  3.616,  3.378,  3.494,  3.556,  3.453 ];

%       sq-LS   sq-VB   1C-VB   1CS-VB  1C-VBI  2C-VB   2C-VBI  BV-VBI  19-VB
OEF = [ 22.47,  23.99,  24.15,  23.06,  25.06,  21.83,  23.80,  25.72,  21.07; ...
        17.92,  18.72,  21.40,  19.22,  25.38,  18.86,  23.87,  25.66,  17.57; ...
        19.68,  20.32,  23.92,  21.16,  23.34,  20.86,  22.28,  25.27,  19.67; ...
        18.66,  19.41,  20.93,  19.17,  23.32,  19.22,  21.88,  24.46,  18.46; ...
        17.78,  19.11,  18.89,  17.64,  21.66,  17.37,  19.68,  22.60,  17.02; ...
        20.20,  22.33,  23.64,  21.88,  25.97,  21.66,  24.55,  26.12,  20.22; ...
        17.11,  19.07,  21.37,  18.70,  21.38,  19.69,  20.39,  23.10,  19.97 ];

% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % %
% % %    MEAN DATA          % % % % % % % % % % % % % % % % % % % % % % % % % %
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % %

% %       sq-LS   sq-VB   1C-VB   1CS-VB  1C-VBI  2C-VB   2C-VBI  BV-VBI
% R2p = [ 3.499,  3.559,  3.547,  3.489,  3.166,  3.727,  3.017,  3.233; ...
%         4.262,  4.362,  4.112,  4.046,  3.360,  4.104,  3.195,  3.409; ...
%         3.475,  3.729,  3.628,  3.322,  2.852,  3.744,  2.714,  2.954; ...
%         3.752,  3.866,  3.908,  3.789,  3.120,  3.818,  2.953,  3.216; ...
%         3.317,  3.490,  3.593,  3.344,  2.943,  3.258,  2.767,  3.035; ...
%         3.861,  3.857,  3.981,  3.957,  3.308,  3.938,  3.156,  3.361; ...
%         3.313,  3.313,  3.152,  3.035,  2.672,  2.969,  2.512,  2.790 ];
%     
% %       sq-LS   sq-VB   1C-VB   1CS-VB  1C-VBI  2C-VB   2C-VBI  BV-VBI
% DBV = [ 4.848,  5.307,  5.635,  6.039,  3.990,  7.930,  3.983,  4.014; ...
%         6.686,  7.653,  6.808,  7.827,  4.149,  7.696,  4.140,  4.195; ...
%         4.997,  5.853,  6.036,  5.959,  3.577,  7.237,  3.519,  3.568; ...
%         5.869,  6.719,  7.036,  7.273,  3.949,  7.800,  3.900,  3.973; ...
%         5.270,  6.103,  7.084,  6.679,  4.255,  7.569,  4.264,  4.271; ...
%         6.036,  6.529,  6.546,  7.702,  4.003,  8.310,  4.025,  4.072; ...
%         5.391,  6.094,  5.136,  6.151,  3.734,  5.709,  3.644,  3.724 ];
% 
% %       sq-LS   sq-VB   1C-VB   1CS-VB  1C-VBI  2C-VB   2C-VBI  BV-VBI
% OEF = [ 32.02,  31.88,  26.94,  27.35,  28.86,  24.87,  27.64,  29.29; ...
%         24.99,  24.56,  24.48,  23.64,  29.47,  23.05,  27.73,  29.28; ...
%         29.47,  28.08,  25.63,  25.89,  28.14,  23.42,  26.90,  29.49; ...
%         24.53,  23.86,  23.66,  22.97,  28.17,  23.12,  26.83,  28.99; ...
%         25.00,  23.84,  21.83,  21.87,  26.57,  22.66,  25.18,  27.49; ...
%         28.19,  28.25,  26.03,  25.00,  29.87,  24.66,  28.29,  29.92; ...
%         25.26,  24.82,  24.06,  22.74,  25.72,  23.08,  24.63,  26.85 ];
    

% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % %
% % %    QUARTILES          % % % % % % % % % % % % % % % % % % % % % % % % % %
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % %

%        sq-LS  sq-VB  1C-VB  1CS-VB  1C-VBI  2C-VB  2C-VBI  BV-VBI  19-VB     -- IQR/2
eR2p = [ 0.99,  1.00,  1.11,  1.03,   0.94,   1.15,  0.95,   0.84,   1.25; ...
         1.44,  1.55,  1.46,  1.45,   1.15,   1.48,  1.18,   1.04,   1.67; ...
         1.26,  1.30,  1.38,  1.30,   1.23,   1.39,  1.21,   1.08,   1.52; ...
         1.33,  1.34,  1.41,  1.32,   1.20,   1.42,  1.22,   1.06,   1.60; ...
         1.14,  1.18,  1.31,  1.21,   1.12,   1.20,  1.10,   0.99,   1.37; ...
         1.27,  1.32,  1.42,  1.35,   1.16,   1.48,  1.16,   1.05,   1.68; ...
         1.03,  1.06,  1.13,  1.09,   1.00,   1.07,  1.00,   0.87,   1.26 ];
    
%        sq-LS  sq-VB  1C-VB  1CS-VB  1C-VBI  2C-VB  2C-VBI  BV-VBI  19-VB     -- IQR/2
eDBV = [ 2.01,  2.15,  1.88,  2.00,   1.21,   2.22,  1.29,   1.23,   2.50; ...
         2.53,  3.02,  2.59,  2.77,   1.16,   3.04,  1.22,   1.16,   3.90; ...
         1.93,  2.14,  2.24,  1.93,   1.28,   2.53,  1.35,   1.25,   2.92; ...
         2.07,  2.25,  2.57,  2.09,   1.32,   3.01,  1.43,   1.31,   3.41; ...
         2.14,  2.45,  2.70,  2.61,   1.69,   2.92,  1.79,   1.69,   3.26; ...
         2.33,  2.58,  2.58,  2.49,   1.41,   3.12,  1.50,   1.42,   3.64; ...
         1.95,  2.09,  1.93,  1.95,   1.21,   2.00,  1.27,   1.18,   2.26 ];


% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % %
% % %    DEVIATIONS         % % % % % % % % % % % % % % % % % % % % % % % % % %
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % %

% %        sq-LS  sq-VB  1C-VB  1CS-VB  1C-VBI  2C-VB  2C-VBI  BV-VBI         -- STD (mean)
% eR2p = [ 3.35,  0.40,  0.46,  0.60,   0.33,   0.54,  0.95,   0.84; ...
%          4.30,  0.65,  0.68,  0.86,   0.42,   0.66,  1.18,   1.04; ...
%          4.38,  0.42,  0.54,  0.62,   0.33,   0.54,  1.21,   1.08; ...
%          4.24,  0.56,  0.63,  0.77,   0.37,   0.65,  1.22,   1.06; ...
%          3.20,  0.45,  0.52,  0.64,   0.34,   0.49,  1.10,   0.99; ...
%          4.00,  0.41,  0.56,  0.69,   0.35,   0.64,  1.16,   1.05; ...
%          4.43,  0.50,  0.50,  0.65,   0.34,   0.52,  1.00,   0.87 ];
% 
% %        sq-LS  sq-VB  1C-VB  1CS-VB  1C-VBI  2C-VB  2C-VBI  BV-VBI        -- STD (mean)
% eDBV = [ 5.93,  2.57,  2.25,  3.00,   1.40,   2.66,  1.46,   1.40; ...
%          7.20,  4.13,  3.46,  4.07,   1.72,   3.32,  1.82,   1.75; ...
%          6.97,  2.84,  2.70,  2.95,   1.39,   2.64,  1.46,   1.40; ...
%          7.57,  3.66,  3.36,  3.79,   1.53,   3.03,  1.60,   1.54; ...
%          5.14,  2.89,  2.57,  3.04,   1.42,   2.50,  1.49,   1.43; ...
%          8.72,  2.61,  2.75,  3.40,   1.45,   3.15,  1.53,   1.48; ...
%          7.24,  3.36,  2.36,  3.13,   1.43,   2.69,  1.49,   1.42 ];
         

% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % %
% % %    FREE ENERGY        % % % % % % % % % % % % % % % % % % % % % % % % % %
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % %

%       sq-LS  sq-VB   1C-VB   1CS-VB  1C-VBI  2C-VB   2C-VBI  BV-VBI  19-VB       -- IQR/2
FE =  [ 4.00,  4.281,  5.474,  4.880,  5.390,  6.007,  5.345,  5.379,  6.136; ...
        4.00,  4.742,  5.912,  5.381,  5.905,  6.016,  5.778,  5.851,  6.499; ...
        4.00,  4.372,  5.488,  4.876,  5.359,  5.692,  5.268,  5.464,  5.850; ...
        4.00,  4.579,  5.918,  5.234,  5.773,  5.900,  5.670,  5.745,  6.283; ...
        4.00,  4.408,  5.998,  5.283,  5.870,  6.173,  5.962,  5.979,  6.053; ...
        4.00,  4.309,  5.863,  5.097,  5.715,  6.169,  5.719,  5.807,  6.637; ...
        4.00,  4.466,  5.837,  5.230,  5.815,  5.945,  5.796,  5.866,  6.330 ];
    
    
%% Calculations  

rebase = 0;

% rebase
if rebase
    eR2p = eR2p./repmat(R2p(:,1),1,8);
    eDBV = eDBV./repmat(DBV(:,1),1,8);
    R2p = R2p./repmat(R2p(:,1),1,8);
    DBV = DBV./repmat(DBV(:,1),1,8);
    OEF = OEF./repmat(OEF(:,1),1,8);
end
     
% averages   
aR2p = mean(R2p);
sR2p = std(R2p);
aDBV = mean(DBV);
sDBV = std(DBV);
aOEF = mean(OEF);
sOEF = std(OEF);
aFE  = mean(FE);
sFE  = std(FE);

% Calculate OEF error by adding R2' and DBV errors in quadrature
eOEF = OEF.*sqrt(((eR2p./R2p).^2) + ((eDBV./DBV).^2));


%% Plotting

% Plot details
dpts = [2,3,5,9];
legtext = {'L-LS','L-VB','1C-VB','1C-S-VB','1C-VB-I','2C-VB','2C-VB-I','2C-VB-I','TC-VB-I'};

npts = repmat((1:length(dpts))',1,7);
lbls = legtext(dpts);
jttr = repmat(-0.06:0.02:0.06,length(dpts),1);

% Plot R2p
figure; hold on; box on;
if rebase
    ylim([0.4,1.6]);
    ylabel('\DeltaR_2'' (s^-^1)');
    plot([0,10],[1,1],'k--','LineWidth',1);
else
    ylim([0.8,4.9]);
    ylabel('R_2'' (s^-^1)');
end
errorbar(npts+jttr,R2p(:,dpts)',eR2p(:,dpts)','.');
plot(npts,R2p(:,dpts)');
errorbar(npts(:,1),aR2p(dpts),sR2p(dpts),'k:','LineWidth',3);
xlim([npts(1)-0.25,npts(end)+0.25]);
ylabel('R_2'' (s^-^1)');
xticks(1:length(dpts));
xticklabels(lbls);

% Plot DBV
figure; hold on; box on;
if rebase
    ylim([0.2,1.8]);
    ylabel('\DeltaDBV');
    plot([0,10],[1,1],'k--','LineWidth',1);
else
    ylim([0,9.25]);
    ylabel('DBV (%)');
end
errorbar(npts+jttr,DBV(:,dpts)',eDBV(:,dpts)','.');
plot(npts,DBV(:,dpts)');
errorbar(npts(:,1),aDBV(dpts),sDBV(dpts),'k:','LineWidth',3);
xlim([npts(1)-0.25,npts(end)+0.25]);
xticks(1:length(dpts));
xticklabels(lbls);

% Plot OEF
figure; hold on; box on;
if rebase
    ylim([0,2]);
    ylabel('\DeltaOEF');
    plot([0,10],[1,1],'k--','LineWidth',1);
else
    ylim([0,47]);
    ylabel('OEF (%)');
end
errorbar(npts+jttr,OEF(:,dpts)',eOEF(:,dpts)','.');
plot(npts,OEF(:,dpts)');
errorbar(npts(:,1),aOEF(dpts),sOEF(dpts),'k:','LineWidth',3);
xlim([npts(1)-0.25,npts(end)+0.25]);

xticks(1:length(dpts));
xticklabels(lbls);

% % Plot Free Energy
figure; hold on; box on;
plot(npts,-FE(:,dpts)');
errorbar(npts(:,1),-aFE(dpts),sFE(dpts),'k:','LineWidth',3);
xlim([npts(1)-0.25,npts(end)+0.25]);
ylim([-6.2,-4.2]);
ylabel('Free Energy');
xticks(1:length(dpts));
xticklabels(lbls);

% % Plot R2p
% FabberBar(R2p(:,datapoints),'R2''',legtext(datapoints));
% 
% % Plot DBV
% FabberBar(DBV(:,datapoints),'DBV',legtext(datapoints));
% 
% % Plot OEF
% if exist('OEF','var')
%     FabberBar(OEF(:,datapoints),'OEF',legtext(datapoints));
% end
% 
