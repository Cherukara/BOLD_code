% Bar Charts

clear;


%% Abstract Data (CSF)
% %       FLAIR  Uncorr T1w    T2w    T2fit  3TE u  3TE f
% DBV = [ 5.40,  8.10,  9.09,  9.74,  8.44,  6.02,  6.28; ...
%         6.61,  8.91,  12.7,  18.0,  12.6, 15.08, 15.53; ...
%         5.45,  5.80,  6.74,  8.14,  5.46,  5.31,  5.39; ...
%         5.50,  7.07,  8.91,  11.9,  8.44,  9.10,  9.25 ];
%     
% %       FLAIR  Uncorr T1w    T2w    T2fit
% R2p = [ 2.57,  4.72,  3.22,  4.14,  2.14,  2.93,  3.27; ...
%         2.61,  5.71,  4.40,  4.66,  1.67,  4.36,  5.18; ...
%         2.29,  3.42,  2.67,  3.82,  2.59,  3.12,  3.43; ...
%         2.51,  3.79,  3.81,  5.34,  1.81,  3.69,  4.30 ];
%     
% OEF = 100*R2p./(3.01*DBV);
    
% %       FLAIR  Uncorr T1w    T2w    T2fit
% erR = [  0.6,   0.9,   0.7,   0.6,   0.8; ...
%          0.9,   0.9,   2.0,   1.0,   2.7; ...
%          0.6,   0.5,   0.8,   0.9,   0.8; ...
%          0.8,   0.6,   0.6,   1.0,   0.8 ];
%      
% %       FLAIR  Uncorr T1w    T2w    T2fit
% erD = [  4.1,   3.0,   3.7,   3.8,   3.0; ...
%          3.0,   3.7,   3.9,   4.0,   4.1; ...
%          3.5,   3.1,   3.7,   4.0,   3.8; ...
%          4.0,   4.7,   4.1,   4.7,   4.8 ];


%% Correct R2 Values
% %       FLAIR  Uncorr T2w     T2fit
% DBV = [ 7.53,  6.40,  10.38,  8.93; ...
%         4.80,  8.27,  40.24, 14.43; ...
%         6.45,  5.70,   8.06,  6.48; ...
%         7.98,  6.88,  12.93,  8.69 ];
%     
% %       FLAIR  Uncorr T2w    T2fit
% R2p = [ 3.05,  3.19,  3.45,  3.38; ...
%         3.01,  3.80,  3.20,  3.00; ...
%         3.09,  3.02,  3.50,  3.13; ...
%         3.25,  3.74,  4.65,  4.05 ];


%% Patient Data
% %       GM     ROI    Contra
% DBV = [ 9.86,  9.75,  7.83; ...
%         6.12,  7.38,  5.86 ];
%     
% %       GM     ROI    Contra
% R2p = [ 4.53,  5.80,  3.70; ...
%         3.60,  4.21,  3.27 ];
%     
% %       GM     ROI    Contra
% OEF = [ 15.3,  19.8,  15.7; ...
%         19.5,  19.0,  18.5 ];


%% Paper Data (sqBOLD)

%       sqB    sq-VB  1C-VB  2C-VB  MN-VB  2C-VBI
DBV = [ 3.68,  3.78,  5.99,  4.52,  6.46,  4.44; ...
        4.84,  5.16,  8.08,  6.55, 10.03,  4.91; ...
        3.38,  4.03,  6.51,  4.70,  8.02,  4.33; ...
        3.96,  4.57,  9.17,  4.56, 11.15,  5.06; ...
        4.07,  4.81, 13.56,  5.11, 12.94,  4.71; ...
        4.04,  4.86,  7.72,  5.68,  8.80,  4.70; ...
        3.72,  4.23,  8.60,  4.71,  7.33,  4.42 ];
    
%       sqB    sq-VB  1C-VB  2C-VB  MN-VB  2C-VBI
R2p = [ 2.81,  2.94,  3.67,  2.90,  3.64,  2.80; ...
        3.08,  3.14,  4.02,  3.19,  3.94,  2.90; ...
        2.24,  2.65,  3.40,  2.46,  3.50,  2.54; ...
        2.53,  3.24,  4.00,  2.72,  4.34,  3.07; ...
        2.52,  2.96,  4.59,  2.63,  4.00,  2.76; ...
        2.89,  3.34,  3.98,  3.05,  4.00,  3.03; ...
        2.26,  2.53,  3.88,  2.37,  3.25,  2.32 ];

OEF = 100*R2p./(3.02*DBV);


%% Plotting

% Plot details
datapoints = [1,2,4,6];
% legtext = {'Grey-Matter Average','Ischaemic ROI','Contra-Ischaemic ROI'};
% legtext = {'with FLAIR','no FLAIR Uncorrected','no FLAIR R1 Correction','no FLAIR R2 Correction','no FLAIR Biexp. Correction'};
% legtext = {'with FLAIR','1 TE, Uncorrected','1 TE, Biexp. Correction','Multi-TE Uncorrected','Multi-TE Biexp. Correction'};
legtext = {'sqBOLD LLS fit','sqBOLD VB','1-comp. qBOLD VB','2-comp. qBOLD VB','Motional Narrowing VB','qBOLD VB-I'};
% subnames = {'Presentation';'24h Post Onset'};
% subnames = {'No Pre-Processing';'Motion Corrected, Smoothed'};

% Plot R2p
FabberBar(R2p(:,datapoints),'R2''',legtext(datapoints));

% Plot DBV
FabberBar(DBV(:,datapoints),'DBV',legtext(datapoints));

% Plot OEF
if exist('OEF','var')
    FabberBar(OEF(:,datapoints),'OEF',legtext(datapoints));
end

