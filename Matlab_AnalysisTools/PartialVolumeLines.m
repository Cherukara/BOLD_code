% PartialVolumeLines.m

% Plot line graphs showing how estimates of a parameter (R2') change with
% respect to the partial volume threshold used to determine the ROI, comparing
% subjects, CSF-correction methods, and GM partial volume estimates.

% MT Cherukara
% 18 March 2019

% CHANGELOG:

clear;
setFigureDefaults;

% Choose Subject
subj = 5;

% PVEs
PVEs = {'99', '90', '80', '70', '60', '50'};
npv = length(PVEs);

%% Data
% Dimensions [ PVE x SUBJECT ]

%            Sub 3      Sub 4      Sub 6      Sub 8      Sub 9
data_FP2 = [ 5.2100,    3.6770,    3.1100,    2.3060,    3.6710; ...
             5.1960,    3.6860,    3.1090,    2.3090,    3.6940; ...
             5.1650,    3.7060,    2.9860,    2.3000,    3.7270; ...
             4.7760,    3.7250,    2.7610,    2.2790,    3.6930; ...
             4.5600,    3.7440,    2.6980,    2.3020,    3.7160; ...
             4.3530,    3.3150,    2.3780,    2.1760,    3.1930; ...
             4.1170,    3.9360,    2.5480,    2.4000,    3.8570 ];
         
%            Sub 3      Sub 4      Sub 6      Sub 8      Sub 9
data_NF2 = [ 5.1740,    4.8020,    3.7150,    3.2840,    3.6640; ...
             5.1390,    4.8130,    3.7250,    3.2750,    3.6790; ...
             4.9780,    4.8450,    3.7060,    3.2750,    3.6770; ...
             4.7140,    4.8670,    3.5630,    3.2650,    3.6490; ...
             4.5570,    4.8980,    3.5020,    3.3190,    3.6560; ...
             4.3840,    4.4440,    3.5670,    2.8460,    3.2260; ...
             4.1690,    5.0220,    3.3000,    3.4400,    3.6920 ];

%            Sub 3      Sub 4      Sub 6      Sub 8      Sub 9
data_NF3 = [ 7.3100,    6.5650,    6.3770,    5.3300,    5.1090; ...
             7.2770,    6.5710,    6.4100,    5.3090,    5.1130; ...
             7.1380,    6.5760,    6.3490,    5.2730,    5.0810; ...
             6.6800,    6.5620,    6.0380,    5.2060,    5.0090; ...
             6.5590,    6.5060,    5.8500,    5.2050,    4.9810; ...
             6.2790,    5.6750,    5.5500,    4.3280,    4.2610; ...
             6.0050,    5.9560,    5.3830,    5.0250,    4.6290 ];

%            Sub 3      Sub 4      Sub 6      Sub 8      Sub 9
data_T1w = [ 6.7910    5.9880    5.4560    5.2340    4.8010
             6.7370    5.9960    5.4750    5.2150    4.8110
             6.5160    6.0080    5.5500    5.2180    4.8520
             6.2590    5.9610    5.4650    5.2050    4.8630
             6.0790    5.9380    5.4290    5.2540    4.8850
             5.9130    5.3590    5.8690    4.2900    4.4390
             5.6760    5.6490    5.2730    5.3190    5.0790 ];

%            Sub 3      Sub 4      Sub 6      Sub 8      Sub 9
data_T2w = [ 4.0610    3.6900    3.5000    2.8820    2.9480
             4.0450    3.6920    3.5010    2.8750    2.9490
             3.9410    3.6940    3.5200    2.8750    2.9570
             3.8710    3.6900    3.5240    2.9070    2.9780
             3.8490    3.6920    3.5260    2.9790    3.0020
             3.8130    3.3550    3.5510    2.6750    2.7850
             3.7450    3.6730    3.4790    3.2910    3.1380 ];

%            Sub 3      Sub 4      Sub 6      Sub 8      Sub 9
data_T2f = [ 7.3540    6.3340    5.5550    6.1990    5.6970
             7.3150    6.3430    5.5840    6.1840    5.7170
             7.1620    6.3480    5.6850    6.1930    5.7040
             6.9120    6.3250    5.6460    6.2210    5.6000
             6.6850    6.2960    5.6720    6.3120    5.5530
             6.4900    5.4230    6.0600    4.9350    4.6870
             6.2590    5.9580    5.5600    6.5030    5.1700 ];


%% Plot Lines
figure;
plot(1:npv,data_FP2(1:6,subj),'x-','Color',defColour(1));
hold on;
plot(1:npv,data_NF2(1:6,subj),'x-','Color',defColour(2));
plot(1:npv,data_NF3(1:6,subj),'x-','Color',defColour(3));
plot(1:npv,data_T1w(1:6,subj),'x-','Color',defColour(4));
plot(1:npv,data_T2w(1:6,subj),'x-','Color',defColour(5));
plot(1:npv,data_T2f(1:6,subj),'x-','Color',defColour(6));

% Labels and stuff
xlabel('GM PV Threshold (%)');
xticklabels(PVEs);
xlim([0.5,npv+0.5]);
ylim([2.0,7.5]);
ylabel('R_2'' (s^-^1)');
title(['Subject ',num2str(subj)]);
legend('FLAIR','NF 2C','NF 3C','NF T1w','NF T2w','NF T2fit');


