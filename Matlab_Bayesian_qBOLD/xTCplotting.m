% xTCplotting.m

clear;
close all;

setFigureDefaults;

tc = 0:2:30;


%   OEF =  20%     30%     40%     50%     60%
d_R2p = [ 1.929,  3.034,  4.202,  5.325,  6.407; ...
          1.936,  3.068,  4.207,  5.327,  6.407; ...
          1.981,  3.090,  4.212,  5.323,  6.405; ...
          2.011,  3.128,  4.252,  5.323,  6.405; ...
          2.011,  3.135,  4.272,  5.321,  6.403; ...
          2.011,  3.143,  4.292,  5.319,  6.401; ...
          2.034,  3.173,  4.302,  5.319,  6.401; ...
          2.041,  3.203,  4.312,  5.319,  6.417; ...
          2.064,  3.214,  4.327,  5.349,  6.467; ...
          2.102,  3.229,  4.357,  5.394,  6.519; ...
          2.139,  3.252,  4.397,  5.485,  6.567; ...
          2.132,  3.278,  4.437,  5.513,  6.641; ...
          2.154,  3.297,  4.467,  5.555,  6.740; ...
          2.169,  3.323,  4.472,  5.603,  6.832; ...
          2.177,  3.346,  4.508,  5.655,  6.864; ...
          2.184,  3.361,  4.538,  5.726,  6.918 ];
      
%   OEF =  20%     30%     40%     50%     60%
d_DBV = [ 1.362,  0.000,  1.331,  1.742,  2.130; ...
          1.432,  1.844,  1.892,  1.261,  2.421; ...
          1.683,  2.045,  2.103,  2.102,  2.481; ...
          1.863,  2.316,  2.594,  2.283,  2.711; ...
          1.874,  2.376,  2.774,  2.243,  2.762; ...
          1.884,  2.446,  2.935,  2.313,  2.802; ...
          2.024,  2.626,  3.025,  2.423,  3.042; ...
          2.074,  2.807,  3.115,  2.653,  3.463; ...
          2.204,  2.887,  3.236,  3.154,  4.044; ...
          2.425,  2.997,  3.446,  3.585,  4.485; ...
          2.645,  3.138,  3.717,  4.106,  4.866; ...
          2.625,  3.308,  3.977,  4.457,  5.357; ...
          2.766,  3.448,  4.198,  4.778,  5.948; ...
          2.876,  3.619,  4.288,  5.098,  6.469; ...
          2.936,  3.769,  4.509,  5.409,  6.699; ...
          2.996,  3.879,  4.719,  5.820,  7.038 ];
   
% %   DBV =  1%      3%      5%       7%
% d_R2p = [ 1.413,  4.193,  6.954,   9.653; ...
%           1.415,  4.193,  6.958,   9.661; ...
%           1.417,  4.193,  6.965,   9.699; ...
%           1.437,  4.196,  7.008,   9.703; ...
%           1.441,  4.193,  7.053,   9.727; ...
%           1.449,  4.193,  7.066,   9.759; ...
%           1.449,  4.198,  7.096,   9.799; ...
%           1.451,  4.208,  7.131,   9.867; ...
%           1.453,  4.251,  7.184,   9.953; ...
%           1.461,  4.291,  7.239,  10.035; ...
%           1.475,  4.351,  7.301,  10.127; ...
%           1.487,  4.389,  7.382,  10.265; ...
%           1.491,  4.419,  7.484,  10.363; ...
%           1.481,  4.456,  7.579,  10.452; ...
%           1.483,  4.496,  7.617,  10.522; ...
%           1.501,  4.551,  7.675,  10.640 ];
%  
% %   DBV =  1%      3%      5%       7%
% d_DBV = [ 0.416,  1.331,  2.315,   3.341; ...
%           0.641,  1.980,  2.985,   4.243; ...
%           0.676,  1.732,  3.366,   5.064; ...
%           0.920,  1.972,  3.988,   5.214; ...
%           0.972,  1.912,  4.409,   5.525; ...
%           1.037,  2.003,  4.529,   5.856; ...
%           1.047,  2.143,  4.769,   6.195; ...
%           1.067,  2.353,  5.030,   6.686; ...
%           1.087,  2.794,  5.371,   7.226; ...
%           1.152,  3.115,  5.732,   7.727; ...
%           1.257,  3.516,  6.113,   8.257; ...
%           1.343,  3.777,  6.574,   8.988; ...
%           1.388,  4.008,  7.155,   9.549; ...
%           1.358,  4.258,  7.677,  10.039; ...
%           1.438,  4.509,  7.917,  10.429; ...
%           1.508,  4.840,  8.269,  11.030 ];


% Proper values
OEF = linspace(0.1,0.7,100);
TCp = 1.7./(354.9633.*OEF);
R2p = 354.9633.*OEF.*0.03;
R_p = 354.9633.*0.03.*[0.2,0.3,0.4,0.5,0.6];

% DBV-based proper values
% DBV = [1,3,5,7];
% R_p = 354.966.*0.4.*0.01*DBV;

% Plot
figure(1); hold on; box on;
plot(tc,d_R2p); 
plot(1000*TCp,R2p,'k-');
plot([0,30],[R_p(1),R_p(1)],'--','LineWidth',1,'Color',defColour(1));
plot([0,30],[R_p(2),R_p(2)],'--','LineWidth',1,'Color',defColour(2));
plot([0,30],[R_p(3),R_p(3)],'--','LineWidth',1,'Color',defColour(3));
plot([0,30],[R_p(4),R_p(4)],'--','LineWidth',1,'Color',defColour(4));
plot([0,30],[R_p(5),R_p(5)],'--','LineWidth',1,'Color',defColour(5)); % OEF only
xlabel('Characteristic Time \tau_c (ms)');
ylabel('Maximum Likelihood R_2'' (s^-^1)');
axis([0, 30, 1, 7]);
% legend('DBV = 1%','DBV = 3%','DBV = 5%','DBV = 7%',...
%        'Location','NorthWest');
legend('OEF = 20%','OEF = 30%','OEF = 40%','OEF = 50%','OEF = 60%');

figure(2); hold on; box on;
plot(tc,d_DBV);
plot([0,30],[3,3],'k-');
% plot([0,30],[1,1],'--','LineWidth',1,'Color',defColour(1)); % for DBV plots
% plot([0,30],[3,3],'--','LineWidth',1,'Color',defColour(2));
% plot([0,30],[5,5],'--','LineWidth',1,'Color',defColour(3));
% plot([0,30],[7,7],'--','LineWidth',1,'Color',defColour(4));
xlabel('Characteristic Time \tau_c (ms)');
ylabel('Maximum Likelihood DBV (%)');
legend('OEF = 20%','OEF = 30%','OEF = 40%','OEF = 50%','OEF = 60%',...
       'Location','NorthWest');
% legend('DBV = 1%','DBV = 3%','DBV = 5%','DBV = 7%',...
%        'Location','NorthWest');
